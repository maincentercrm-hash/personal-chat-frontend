# 01 - CRITICAL: ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Text Editor / Input Box

**‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: üî¥ CRITICAL (‡πÅ‡∏Å‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏∏‡∏î)**
**‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å: ‚≠ê ‡∏á‡πà‡∏≤‡∏¢-‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á**

---

## üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### #3: ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÑ‡∏õ‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏≤‡∏¢‡πÑ‡∏õ
**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á input ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏ä‡∏ó, ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å input)
- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏ß‡πâ‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ persist state

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö draft message ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞ conversation
- Component re-render ‡∏´‡∏£‡∏∑‡∏≠ unmount ‡∏ó‡∏≥‡πÉ‡∏´‡πâ state ‡∏´‡∏≤‡∏¢

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏™‡∏£‡πâ‡∏≤‡∏á state management ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö draft messages (localStorage ‡∏´‡∏£‡∏∑‡∏≠ zustand store)
2. ‡πÄ‡∏Å‡πá‡∏ö draft ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° conversationId
3. Load draft ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà conversation ‡πÄ‡∏î‡∏¥‡∏°

**Backend ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:** ‚ùå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á (‡πÅ‡∏Å‡πâ frontend ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)

---

### #4: ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡πà‡∏≠
**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡∏´‡∏£‡∏∑‡∏≠ action ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
- ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á input ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ
- input box ‡πÄ‡∏™‡∏µ‡∏¢ focus

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- ‡πÑ‡∏°‡πà‡∏°‡∏µ auto-focus ‡∏´‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
- Event handling ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ focus ‡∏´‡∏≤‡∏¢

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡πÉ‡∏ä‡πâ `useRef` ‡πÅ‡∏•‡∏∞ `.focus()` ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
2. ‡∏ï‡∏±‡πâ‡∏á `autoFocus` ‡πÉ‡∏´‡πâ input
3. ‡πÄ‡∏û‡∏¥‡πà‡∏° focus management ‡πÉ‡∏ô useEffect

**Backend ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:** ‚ùå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á

---

### #5: ‡πÄ‡∏ß‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡∏Å‡∏î Enter ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ß‡∏¥‡∏ò‡∏µ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- ‡πÉ‡∏ä‡πâ `<input>` ‡πÅ‡∏ó‡∏ô `<textarea>`
- ‡∏´‡∏£‡∏∑‡∏≠ handleKeyDown ‡∏à‡∏±‡∏ö Enter ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å `<input>` ‡πÄ‡∏õ‡πá‡∏ô `<textarea>`
2. ‡πÅ‡∏Å‡πâ KeyDown handler: `Shift+Enter` = ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà, `Enter` = ‡∏™‡πà‡∏á
3. ‡∏õ‡∏£‡∏±‡∏ö CSS ‡πÉ‡∏´‡πâ textarea ‡∏°‡∏µ min-height ‡πÅ‡∏•‡∏∞ auto-grow

**Backend ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:** ‚ùå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á

---

### #14: ‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏Ñ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏•‡∏∏‡∏° (Selection Cursor)
**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏Ñ‡∏•‡∏∏‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô input box ‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô cursor ‡∏´‡∏£‡∏∑‡∏≠ selection highlight

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- CSS ‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô selection style
- `user-select: none` ‡∏´‡∏£‡∏∑‡∏≠ `::selection { background: transparent }`

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö CSS ‡∏Ç‡∏≠‡∏á input/textarea
2. ‡πÄ‡∏û‡∏¥‡πà‡∏° `::selection` style:
```css
textarea::selection,
input::selection {
  background: #3b82f6;
  color: white;
}
```

**Backend ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:** ‚ùå ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á

---

### #22: ‡∏ï‡∏±‡∏ß‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß text ‡∏¢‡∏±‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏≠‡∏≠‡∏£‡πå (‡πÅ‡∏Å‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤)
**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
- ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ú‡∏¥‡∏î ‡∏´‡∏£‡∏∑‡∏≠ state ‡πÑ‡∏°‡πà sync

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:**
- Real-time update ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
- WebSocket event ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ handle
- Local state ‡∏Å‡∏±‡∏ö server state ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö WebSocket event handler ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö message edit
2. Update local state ‡∏´‡∏•‡∏±‡∏á edit ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (optimistic update + rollback on fail)
3. Sync state ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á local ‡πÅ‡∏•‡∏∞ server

**Backend ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥:** ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á WebSocket event ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
- Event: `message.updated`
- Payload: `{ messageId, newContent, editedAt }`

---

## üéØ ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö)

1. **#5 - ‡πÄ‡∏ß‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ** (‡∏á‡πà‡∏≤‡∏¢‡∏™‡∏∏‡∏î, ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡∏π‡∏á)
   - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô input ‚Üí textarea
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° Shift+Enter handler

2. **#4 - ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î input ‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö** (‡∏á‡πà‡∏≤‡∏¢)
   - ‡πÄ‡∏û‡∏¥‡πà‡∏° auto-focus

3. **#3 - ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏≤‡∏¢** (‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á)
   - ‡∏™‡∏£‡πâ‡∏≤‡∏á draft system

4. **#14 - ‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô cursor** (‡∏á‡πà‡∏≤‡∏¢)
   - ‡πÅ‡∏Å‡πâ CSS

5. **#22 - ‡πÅ‡∏Å‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÄ‡∏≠‡∏≠‡∏£‡πå** (‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á)
   - ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö backend ‡πÅ‡∏Å‡πâ WebSocket

---

## üì¶ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ

- `src/components/Chat/MessageInput.tsx` (‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ)
- `src/stores/` (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö draft messages)
- `src/services/websocket.ts` (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö #22)

---

## ‚úÖ ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£ Test

- [x] ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏™‡∏•‡∏±‡∏ö conversation ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà
- [x] ‡∏Å‡∏î Shift+Enter ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ
- [x] ‡∏Å‡∏î Enter ‡πÄ‡∏â‡∏¢‡πÜ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
- [x] ‡∏´‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° cursor ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏µ‡πà input box ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- [x] ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô highlight ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- [x] ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° update ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
