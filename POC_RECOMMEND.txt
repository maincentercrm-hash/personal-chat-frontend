‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏±‡πâ‡∏ô ‡πÜ: ‡πÉ‡∏ä‡πà‡∏Ñ‡∏£‡∏±‡∏ö! ‚Äú‡∏ó‡∏≥ message ‡πÉ‡∏´‡πâ predictable ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≤‡∏î‡πÄ‡∏î‡∏≤‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‚Äù ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ visual scrolling ‡∏•‡∏∑‡πà‡∏ô ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô LINE / Messenger / Telegram
‡πÅ‡∏ï‡πà‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ ‚Äú‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‚Äù ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà fixed height ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

‡∏ú‡∏°‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏õ‡πÉ‡∏´‡∏ç‡πà ‡πÜ ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ô (‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå dev chat app) üëá

‚úÖ 1) ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á Message Layout (Message Type ‡πÉ‡∏´‡πâ Simple ‡πÅ‡∏•‡∏∞ Height ‡∏Ñ‡∏≤‡∏î‡πÄ‡∏î‡∏≤‡∏á‡πà‡∏≤‡∏¢)

Messenger / LINE / Discord ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ layout ‡πÅ‡∏õ‡∏•‡∏Å ‡πÜ
‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡πâ message:

padding ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô

margin ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô

bubble style ‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠

‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ layout ‡∏ó‡∏µ‡πà dynamic ‡∏°‡∏≤‡∏Å ‡πÄ‡∏ä‡πà‡∏ô flex-wrap ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô

‡∏£‡∏π‡∏õ/‡∏†‡∏≤‡∏û‡∏°‡∏µ aspect ratio ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà

sticker ‡∏°‡∏µ frame ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà

‡∏ú‡∏•:
üëâ browser / mobile engine ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì layout ‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å
üëâ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á reflow DOM ‡πÄ‡∏¢‡∏≠‡∏∞ ‚Üí scroll ‡∏•‡∏∑‡πà‡∏ô

‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà ‚Äú‡πÅ‡∏°‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∞‡∏¢‡∏≤‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡πÅ‡∏ï‡πà layout predictable‚Äù ‡∏ó‡∏≥‡πÉ‡∏´‡πâ engine optimize ‡πÑ‡∏î‡πâ‡∏î‡∏µ

‚úÖ 2) ‡πÉ‡∏ä‡πâ Virtualized List (‡πÅ‡∏ï‡πà‡πÅ‡∏ö‡∏ö‡∏â‡∏•‡∏≤‡∏î)

LINE / Telegram / FB Messenger ‡πÉ‡∏ä‡πâ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î virtualization + recycling ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô native mobile:

element ‡πÄ‡∏Å‡πà‡∏≤‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥ (recycle)

‡πÑ‡∏°‡πà render ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô viewport)

‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤

‡πÉ‡∏ä‡πâ placeholder height ‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏à‡∏£‡∏¥‡∏á

React ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤:

react-window

react-virtualized

react-virtuoso (‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ)

‡∏ú‡∏•:
üëâ DOM ‡πÄ‡∏ö‡∏≤
üëâ scroll ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å‡πÅ‡∏°‡πâ‡∏°‡∏µ 10,000+ messages

‚úÖ 3) ‡πÉ‡∏ä‡πâ "Sticky to Bottom" + ‚ÄúSmart Auto-Scroll‚Äù

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤:

‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡πà‡∏≤‡∏ô ‚Üí ‡∏´‡πâ‡∏≤‡∏° auto-scroll

‡∏ñ‡πâ‡∏≤ user ‡∏≠‡∏¢‡∏π‡πà‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î ‚Üí auto-scroll to bottom (‡∏î‡πâ‡∏ß‡∏¢ smooth ‡∏´‡∏£‡∏∑‡∏≠ instant)

‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á trigger ‚âà 50px

‡∏ú‡∏•:
üëâ UX ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î
üëâ Scroll ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å‡∏ï‡∏≠‡∏ô push message ‡πÉ‡∏´‡∏°‡πà

‚úÖ 4) Pre-Compute Height (‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡πÑ‡∏î‡πâ)

‡∏ö‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• message ‡πÄ‡∏ä‡πà‡∏ô:

text ‚Üí ‡πÉ‡∏ä‡πâ algorithm ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì line count

image ‚Üí ‡∏™‡∏π‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏π‡πâ‡∏à‡∏≤‡∏Å metadata

sticker ‚Üí fixed height

‡∏ñ‡πâ‡∏≤‡∏£‡∏π‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ = virtualization ‡∏à‡∏∞‡∏•‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏Å

‡πÅ‡∏ï‡πà ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á fixed height ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
‡πÅ‡∏Ñ‡πà ‚Äú‡∏û‡∏≠‡πÄ‡∏î‡∏≤‡πÑ‡∏î‡πâ‚Äù ‡∏Å‡πá‡∏û‡∏≠

‚úÖ 5) ‡πÉ‡∏ä‡πâ IntersectionObserver + Passive Event Listener

‡πÉ‡∏´‡πâ scroll event ‡πÑ‡∏°‡πà block main thread

passive: true ‡∏ó‡∏≥‡πÉ‡∏´‡πâ scroll ‡πÑ‡∏°‡πà delay

‡πÑ‡∏°‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô logic ‡∏´‡∏ô‡∏±‡∏Å ‡πÜ ‡πÉ‡∏ô scroll event

‡πÉ‡∏ä‡πâ IntersectionObserver ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏ñ‡∏∂‡∏á‡∏ö‡∏ô/‡∏•‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á

‡∏ú‡∏•:
üëâ 120fps scroll ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏´‡∏ß

‚ùå ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏µ‡πà ‚Äú‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏ó‡∏≥‚Äù ‡∏´‡∏≤‡∏Å‡∏≠‡∏¢‡∏≤‡∏Å‡∏•‡∏∑‡πà‡∏ô

message layout dynamic ‡∏°‡∏≤‡∏Å, ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô margin/padding ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô

‡πÉ‡∏ä‡πâ shadow, blur, filter ‡∏´‡∏ô‡∏±‡∏Å ‡πÜ

animated layout

‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô DOM ‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÜ ‡∏ï‡∏≠‡∏ô scroll

‡πÉ‡∏ä‡πâ CSS ‡∏ó‡∏µ‡πà strong reflow ‡πÄ‡∏ä‡πà‡∏ô table, nested flex ‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô

üéØ ‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ö‡∏ö ‚Äú‡∏ï‡∏£‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‚Äù
‚ùì‚Äú‡∏ó‡∏≥ message type ‡πÉ‡∏´‡πâ simple ‡πÅ‡∏•‡∏∞ height ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏´‡∏°‡∏î = ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°?‚Äù

‡∏ä‡πà‡∏ß‡∏¢‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏´‡∏°‡∏î
‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ñ‡∏∑‡∏≠:

predictable layout

‡πÑ‡∏°‡πà‡∏°‡∏µ dynamic reflow

virtualization + recycling

smart auto-scroll

üí° ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà Messenger ‡∏•‡∏∑‡πà‡∏ô‡∏°‡∏≤‡∏Å:

bubble layout simple

virtualization

pre-calc position

DOM recycle

passive scroll event

---------------------

‡∏à‡∏±‡∏î‡πÉ‡∏´‡πâ‡πÅ‡∏ö‡∏ö ‡πÇ‡∏Ñ‡πâ‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô pattern ‡∏ó‡∏µ‡πà‡∏•‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô React ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ
‡πÉ‡∏ä‡πâ react-virtuoso (‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ react-window ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö list ‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô)

üöÄ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á React Chat Virtualized (‡πÇ‡∏Ñ‡∏ï‡∏£‡∏•‡∏∑‡πà‡∏ô‡πÅ‡∏ö‡∏ö LINE/Telegram)
1) ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á
npm install react-virtuoso

2) ChatList.tsx ‚Äî Virtualized Chat + AutoScroll ‡πÅ‡∏ö‡∏ö LINE
import { Virtuoso, VirtuosoHandle } from "react-virtuoso";
import { useEffect, useRef, useState } from "react";

export default function ChatList({ messages }: { messages: any[] }) {
  const virtuosoRef = useRef<VirtuosoHandle>(null);
  const [isAtBottom, setIsAtBottom] = useState(true);

  // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà ‚Üí auto scroll ‡∏ñ‡πâ‡∏≤ user ‡∏≠‡∏¢‡∏π‡πà‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î
  useEffect(() => {
    if (isAtBottom) {
      virtuosoRef.current?.scrollToIndex({
        index: messages.length - 1,
        align: "end",
        behavior: "auto",
      });
    }
  }, [messages]);

  return (
    <Virtuoso
      ref={virtuosoRef}
      data={messages}
      followOutput={(isAtBottom) => {
        // react-virtuoso ‡∏à‡∏∞‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ user ‡∏≠‡∏¢‡∏π‡πà‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡πÑ‡∏´‡∏°
        setIsAtBottom(isAtBottom);
        return isAtBottom;
      }}
      itemContent={(index, message) => (
        <MessageBubble key={message.id} message={message} />
      )}
      style={{ height: "100%", width: "100%" }}
    />
  );
}

3) MessageBubble.tsx ‚Äî Layout ‡πÅ‡∏ö‡∏ö LINE ‡∏ó‡∏µ‡πà‡∏•‡∏∑‡πà‡∏ô‡∏™‡∏∏‡∏î

‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: layout simple, predictable, padding ‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‚Üí scroll ‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡∏Å

export const MessageBubble = ({ message }: any) => {
  const isMine = message.sender === "me";

  return (
    <div
      style={{
        display: "flex",
        justifyContent: isMine ? "flex-end" : "flex-start",
        padding: "4px 12px",
      }}
    >
      <div
        style={{
          background: isMine ? "#b7e6ff" : "#ffffff",
          padding: "8px 12px",
          borderRadius: "12px",
          maxWidth: "70%",
          fontSize: "15px",
          lineHeight: "20px",
          boxShadow: "0 1px 2px rgba(0,0,0,0.1)",
        }}
      >
        {message.text}
      </div>
    </div>
  );
};

4) ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô ChatPage.tsx
import ChatList from "./ChatList";
import { useState } from "react";

export default function ChatPage() {
  const [messages, setMessages] = useState([
    { id: 1, sender: "me", text: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö" },
    { id: 2, sender: "other", text: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö üôå" },
  ]);

  const send = (text: string) => {
    setMessages((prev) => [
      ...prev,
      { id: Date.now(), sender: "me", text }
    ]);
  };

  return (
    <div style={{
      height: "100vh",
      display: "flex",
      flexDirection: "column"
    }}>
      <div style={{ flex: 1 }}>
        <ChatList messages={messages} />
      </div>

      {/* input ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ */}
      <div style={{ padding: 12, display: "flex", gap: 8 }}>
        <input id="msg" style={{ flex: 1 }} />
        <button
          onClick={() => {
            const text = (document.getElementById("msg") as HTMLInputElement).value;
            send(text);
          }}
        >
          ‡∏™‡πà‡∏á
        </button>
      </div>
    </div>
  );
}

‚ö° ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∑‡πà‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö LINE/Telegram ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å 5 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
1) ‡πÉ‡∏ä‡πâ react-virtuoso ‚Üí ‡πÑ‡∏°‡πà render DOM ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô

DOM ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà ~20 ‡∏ä‡∏¥‡πâ‡∏ô ‚Üí ‡∏Å‡∏≤‡∏£ scroll = 120 fps

2) followOutput() ‚Üí Auto-scroll ‡πÅ‡∏ö‡∏ö LINE

‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î ‡πÑ‡∏°‡πà‡∏°‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡πà‡∏≤

3) Layout ‡∏Ç‡∏≠‡∏á bubble ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏á‡πà‡∏≤‡∏¢ predictable

‡πÑ‡∏°‡πà‡∏°‡∏µ nested flex ‡∏ã‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏ä‡∏±‡πâ‡∏ô

4) Recycle DOM element

‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô native mobile (recycler view)

5) ‡πÑ‡∏°‡πà re-render list ‡∏ó‡∏±‡πâ‡∏á‡∏Å‡πâ‡∏≠‡∏ô

Virtuoso ‡∏ó‡∏≥ incremental update